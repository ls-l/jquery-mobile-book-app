<!DOCTYPE html>
<html>
    <head>
        <title>Home</title>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initil-scale=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="css/query.css"/>
        <link rel="stylesheet" type="text/css" href="css/custom.css"/>
        <!--<link rel="stylesheet" href="css/jquery.mobile-1.2.0.min.css">
         <script src="javascript/js/jquery-1.8.2.min.js"></script>
         <script src="javascript/js/jquery.mobile-1.2.0.min.js"></script>-->


        <!--<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css">
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>-->

        <!--Apply Image Dragable Script-->
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0a2/jquery.mobile-1.0a2.min.css" />

<!--<script src="http://code.jquery.com/jquery-1.4.4.min.js"></script>-->
        <script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>

        <script src="http://code.jquery.com/mobile/1.0a2/jquery.mobile-1.0a2.min.js"></script>
            <!--<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.7/jquery-ui.min.js"></script>-->

        <script src="http://code.jquery.com/ui/1.8.21/jquery-ui.min.js"></script>
        <!--Apply Image Dragable Script-->


        <script src="javascript/js/jquery.ui.touch-punch.js"></script>
        <script src="js/chapter.js"></script>  

        <style id="jsbin-css">
        </style>
        <style type="text/css">
            .unselectable {
                -webkit-user-select: none; /* Safari, Chrome */
                -khtml-user-select: none; /* Konqueror */
                -moz-user-select: none; /* Firefox */
                -webkit-touch-callout: none;
                -ms-user-select: none;
                -o-user-select: none;
                user-select: none; /* CSS3 */
            }
        </style>
        <title>example-of-chapter</title>
    </head>

    <body>
        <div data-role="page">
            <div data-role="content">
                <div class="inner_bg">
                    <div class="example-chep">
						<div class="top-popup-menu" id="first_top_div">
							<ul>
								<li class="heart2-icon"><a href="javascript:void(0);" class="top-icon-menu"></a></li>
								<li class="tag-popup-icon"><a href="javascript:void(0);" class="top-icon-menu"></a></li>
								 <li class="plus-icon"><a href="javascript:void(0);" class="top-icon-menu"></a></li>
								<div class="cls"></div>
							</ul>
					     </div>
						 <div class="cls"></div>						  
                        <div class="top-menu" id="second_top_div" style="height:6%;margin-top:0px; display:none;">
                            <ul>
                                <li class="setting-icon"><a href="#"></a></li>
                                <li class="heart-icon second_topmenu"><a href="#"></a></li>
                                <li class="time-icon"><a href="#"></a></li>
                                <!--<li class="pen-icon"><a href="javascript:void(0);" onClick="return select_highlight();"></a></li>-->
								<li class="pen-icon"><a href="javascript:void(0);" onClick=""></a></li>
                                <li class="pin-icon"><a href="#"></a></li>
                                <li class="search-icon"><a href="#"></a></li>
                                <li class="tag-icon" id="tag_icon_small" style="position:relative;">
                     
                                </li>
                                <!--<img src="http://localhost/acim/images/exp-tag.png" class="draggable ui-draggable" alt="Book Mark"/>-->
                                <div class="cls"></div>
                            </ul>
                            <ul class="secd_line_icon" id="secd_line_icon">
                                <li class="icon1" id="p_icon1">
                                    
                                </li>
                                <li class="icon2" id="p_icon2" style="margin-left:20%">
                                    
                                </li>
                                <li class="icon3" id="p_icon3" style="margin-left:40%">
                                    
                                </li>
                                <li class="icon4" id="p_icon4" style="margin-left:60%">
                                    
                                </li>
                                <li class="icon5" id="p_icon5" style="margin-left:80%">
                                    
                                </li>
                            </ul>
                        </div>
                        <!--          <div class="midd-cont" style="height:77%">-->
                        <div class="midd-cont" style="height:80%;margin-top:10px;">
                            
                            <h4 id="p_chno"></h4>
                            <p id="p_chname"></p>
                            
                            <div class="chapter-detail droppable123" style="" id="p_droppable">
                                
                                
                                
                                
                            </div>
                            <div style="clear:both;"></div>
                            
                        </div>
                        <div class="footer-cont" style="height:14%;margin-top:0px;">
                            <span class="left-arrow" id="p_left_arrow">
                                
                            </span>
                            <div class="pagination" id="p_pagination">
                                
                            </div>
                            <span class="right-arrow" id="p_right_arrow">
                                
                            </span>
                            <div class="cls"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
		<div class="pop-up" id="content_popup">
          	<div class="pop-top"></div>
           <div class="pop-midd">
          	<ul class="pop-icon">
            	<li class="pop-icon1"><a href="#"><span></span></a></li>
                <li class="pop-icon2"><a href="#"><span></span></a></li>
                <li class="pop-icon3"><a href="#"><span></span></a></li>
                <li class="pop-icon4"><a href="#"><span></span></a></li>
                <div class="cls"></div>
            </ul>
            <ul class="pop-icon">
                <li class="pop-icon5"><a href="#"><span></span></a></li>
                <li class="pop-icon6"><a href="#"><span></span></a></li>
                <li class="pop-icon7"><a href="#"><span></span></a></li>
                <li class="pop-icon8"><a href="javascript:void(0);" id="popup_desc"><span></span></a> </li>
                <div class="cls"></div>
            </ul>
            </div> 
          </div>
        <div class="pop-up" id="content_popup_big" style="display:none;">
          	<div class="pop-top"></div>
           <div class="pop-midd">
          	<ul>
            	<li class="pop-icon1"><a href="#"><span></span><label>-lets you mark a sections of readings with icons.</label><div class="cls"></div></a>
                <li class="pop-icon2"><a href="#"><span></span><label>-let's you bookmark where you left off in your readings</label><div class="cls"></div></a>
                <li class="pop-icon3"><a href="#"><span></span><label>-let's you highlight section of text.</label><div class="cls"></div></a>
                <li class="pop-icon4"><a href="#"><span></span><label>-let's you search for keywords in the text.</label><div class="cls"></div></a>
                <li class="pop-icon5"><a href="#"><span></span><label>-let's you take notes about and part or the text.</label><div class="cls"></div></a>
                <li class="pop-icon6"><a href="#"><span></span><label>-let's you share/email any part of the text.</label><div class="cls"></div></a>
                <li class="pop-icon7"><a href="#"><span></span><label>-let's you set reminders to help you through the course.</label><div class="cls"></div></a>
                <li class="pop-icon8"><a href="#"><span></span><label>-tells you about the tools.</label><div class="cls"></div></a> 
            </ul>
            </div> 
          </div>
 
        <script type="text/javascript" language="javascript">
            $(document).ready(function() {
			
                $("#content_area").click(function() { 
				     if($('#content_popup').css('display') == 'none' && $('#content_popup_big').css('display') == 'none'){
					    $('#content_popup').show(); 
					 } else {
					    $('#content_popup').hide();
						$('#content_popup_big').hide();
					 }
				});
				$("#popup_desc").click(function() { 
					    $('#content_popup').hide();
						$('#content_popup_big').show();
				});
				$('.ui-content').css("overflow-y",'hidden'); 
                $(".second_topmenu").click(function() {                          
                    if($('#secd_line_icon').css('display') == 'none'){
                        $('.top-menu').css("height",'9%');
                        $('.midd-cont').css("height",'81%');
                        $('#secd_line_icon').show();                              
                    } else {
                        $('.top-menu').css("height",'6%');
                        $('.midd-cont').css("height",'84%');
                        $('#secd_line_icon').hide();                              
                    }
                });
                      
                      
                var h_main=$(window).height();
                var h=$(".inner_bg").height();
                var w=$(".inner_bg").width();
                var h_bookmark=$(".get-icon").height();
			 
                var dragablediv = h-(h/2.5);
			    
				$(".top-icon-menu").click(function(){
				    $("#first_top_div").hide();
					$("#second_top_div").show();
				});
                $("#bookmark_icon").css("height", dragablediv);
		//$(".clcik-delete").hover(function(){
                    //alert('hi');
                    //$(this).find('.clcik-delete').data('id');
                //});	 
                $(function() {
			 
                    var dragOptions = {
                        revert: "invalid",
                        scope: "items",
                        helper: "clone"
                    }
                    //$(".drag").draggable();
			 
                    /* $('.drag123').draggable({
                                       revert: "invalid",
                                       scope: "items"
                               });*/
                    $('.drag').draggable({
                        revert: "invalid",
                        scope: "items"
                    });
                    $('.droppable123').droppable({
                        scope: "items",
                        drop: function(event, ui) {
                            var el = ui.helper.context;
							//$(el).animate({'left':'0px'},1000); //1000 = 1second
							var iconno = $(el).data("id").toString();
							//console.log(el);
							var record_db = $(el).data("db");
							var icon_last_p = $(el).position();
				            var drag_area = $('.droppable123').position();
							var ani_left = ($(".midd-cont").offset().left - $(el).parent().parent().offset().left) + 65;
							
							
                            if(iconno[0] == 'h'){
                                iconno = iconno.substring(1);
                                var icon_type = 'heart';
								var drag_icon = $('.icon2').position();
								 var icon_left = (drag_area.left + drag_icon.left);		 
								 if(record_db == "1"){
								    $(el).animate({'left':'0px'},2000); //1000 = 1second
								 } else {
								    //$(el).animate({'left':'-129px'},2000); 
									$(el).animate({'left':ani_left+'px'},2000); 
                                 }
							}
                            else if(iconno[0] == 's'){
                                iconno = iconno.substring(1);
                                var icon_type = 'star';
								var drag_icon = $('.icon1').position();
							    var icon_left = (drag_area.left + drag_icon.left);
								if(record_db == "1"){
								    $(el).animate({'left':'0px'},2000); //1000 = 1second
								 } else {
								    //$(el).animate({'left':'11px'},2000); //1000 = 1second
                                    $(el).animate({'left':ani_left+'px'},2000); 
								 }
							}
                            else if(iconno[0] == 'y'){
                                iconno = iconno.substring(1);
                                var icon_type = 'yellow';
								var drag_icon = $('.icon3').position();
								var icon_left = (drag_area.left + drag_icon.left);		 
								if(record_db == "1"){
								    $(el).animate({'left':'0px'},2000); //1000 = 1second
								 } else {
								    //$(el).animate({'left':'-274px'},2000); //1000 = 1second
                                    $(el).animate({'left':ani_left+'px'},2000); 
								 }
							}
                            else if(iconno[0] == 'm'){
                                iconno = iconno.substring(1);
                                var icon_type = 'mark';
								var drag_icon = $('.icon4').position();
								var icon_left = (drag_area.left + (drag_icon.left*3));		 
								if(record_db == "1"){
								    $(el).animate({'left':'0px'},2000); //1000 = 1second
								 } else {
								    //$(el).animate({'left':'-414px'},2000); //1000 = 1second
                                    $(el).animate({'left':ani_left+'px'},2000); 
								 }
							}
                            else if(iconno[0] == 'b'){
                                iconno = iconno.substring(1);
								var icon_type = 'bulb';
                               var drag_icon = $('.icon5').position();
							   var icon_left = (drag_area.left + (drag_icon.left*4));		 
							   if(record_db == "1"){
								    $(el).animate({'left':'0px'},2000); //1000 = 1second
								 } else {
							        //$(el).animate({'left':'-554px'},2000); //1000 = 1second
                                    $(el).animate({'left':ani_left+'px'},2000); 
								 }
							}
                            else {
                                var icon_type = 'bookmark'; 
								if(record_db == "1"){
								    //$( this ).addClass('active'); 
									$(el).animate({'left':'0px'},2000); //1000 = 1second
								 } else {
								    /*$(el).animate({'left':'-647px'},2000,function(){
									    $(el).css({backgroundSize:'60% 60%'})
									});*/ 
									var ani_left = ($(".midd-cont").offset().left - $(el).parent().offset().left) + 65;
									$(el).animate({'left':ani_left+'px'},2000,function(){
									    $(el).css({backgroundSize:'60% 60%'})
									});
									 
                                 } 
							}
                            var pos = ui.draggable.position();
                            //alert('top: ' + pos.top+ ', left: ' + pos.left);
                            //alert(h+"---"+pos.top+"-----"+h_bookmark);
				            
                            var pos = ui.draggable.offset(), dPos = $(this).offset();
                            var leftposition = (pos.left - dPos.left);
							
							//$(this).offset().left.css({'left':'3px'});
							/*alert("data-id: " + ui.draggable.data("data-id") + 
                                                       ", Top: " + (pos.top - dPos.top) + 
                                                       ", Left: " + (pos.left - dPos.left));*/
                            //var topposition = (pos.top/h)*100;   
                            //var topposition = ((pos.top - dPos.top)/h)*100;
                            var topposition = (pos.top - dPos.top);
							
							
				            
							
                            var url = "icon_insert.php?pageno=<?php echo $pageno; ?>&chid=<?php echo $chid; ?>&chno=<?php echo $chno; ?>&bookid=<?php echo $bookid; ?>&topposition="+topposition+"&iconno="+iconno+"&icon_type="+icon_type;
                            var data = '';
                            $.ajax({
                                url: url,
                                data: data,
                                dataType: 'json',
                                success: function() {
                                    if(rsp.success) {
                                        alert(rsp);
                                    }
                                }
                            });
				 
				   
                        }
                        // if you want to disable the dragging after drop un-comment this
                        /*
                                       drop: function(e, ui) {
                                               $(ui.draggable).draggable({"disabled":true});
                                       }
                         */
                    });
                });
		  		 
            });
            function redirect_page(str){
				location.href = str;
            }
		   
            function select_highlight(){
                $("#content_area").removeClass("unselectable");   
                $('#content_area').mousedown(function() {
                    $('#content_area').mouseup(function() {   
                        if(window.getSelection) {  
                            var SelText = window.getSelection();
                            if(SelText != ''){
                                var url = "highlighted_icon_insert.php?pageno=<?php echo $pageno; ?>&chid=<?php echo $chid; ?>&chno=<?php echo $chno; ?>&bookid=<?php echo $bookid; ?>&content="+SelText;
                                var data = '';
                                $.ajax({
                                    url: url,
                                    data: data,
                                    dataType: 'json',
                                    success: function() {
                                        if(rsp.success) {
                                            alert(rsp);
                                        }
                                    }
                                });
                                var content_ch = $('#content_area').html();
                                if(content_ch != ''){
                                    //var content_ch1 = content_ch.replace(/content/g, '<span class="background-yello">'+SelText+'</span>');
                                    var content_ch1 = content_ch.replace(new RegExp('(' + SelText + ')', 'g'), '<span class="background-yello">'+SelText+'</span>');
                                    $('#content_area').html(content_ch1); 
                                }
                            }
                        }
                    });
                });
            }
		   
        </script>
    </body>
</html>
